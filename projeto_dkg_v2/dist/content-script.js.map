{"version":3,"file":"content-script.js","mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://ci/./src/content-script/content-script.ts"],"sourcesContent":["let escutaEstaAtiva = false;\nlet listenerRegistrado = false;\nchrome.storage.local.get(\"escutando\", (r) => {\n    if (r.escutando) {\n        escutaEstaAtiva = true;\n        capturarCliques();\n    }\n});\nchrome.storage.onChanged.addListener((changes, area) => {\n    if (area === \"local\" && changes.escutando) {\n        escutaEstaAtiva = changes.escutando.newValue === true;\n        if (escutaEstaAtiva) {\n            capturarCliques();\n        }\n        else {\n            chrome.storage.local.remove([\"dkg\"]);\n        }\n    }\n});\nfunction capturarCliques() {\n    if (escutaEstaAtiva && !listenerRegistrado) {\n        listenerRegistrado = true;\n        document.addEventListener('click', (e) => { handleClick(e); });\n    }\n}\nfunction handleClick(event) {\n    const inputBusca = document.querySelector('input[name=\"q\"]');\n    if (!inputBusca)\n        return;\n    const valorAtual = inputBusca.value.trim();\n    const valorAnterior = localStorage.getItem(\"valorAnterior\") || \"\";\n    const igualdade = valorAtual === valorAnterior;\n    processarClique(event, igualdade, valorAtual);\n    localStorage.setItem(\"valorAnterior\", valorAtual);\n}\nfunction processarClique(event, igualdade, valorAtual) {\n    const target = event.target;\n    const linkClicado = target.closest('a');\n    if (!linkClicado)\n        return;\n    event.preventDefault();\n    const resultados = Array.from(document.querySelectorAll('div.b8lM7'))\n        .map(div => div.querySelector('a'))\n        .filter((a) => !!a && !a.closest('[jsname=\"yEVEwb\"]'));\n    const index = resultados.findIndex(a => a.href === linkClicado.href);\n    if (index === -1 || index >= 10) {\n        console.log('❌ Clique fora dos top 10 resultados orgânicos ou em seção desconsiderada.');\n        return;\n    }\n    chrome.storage.local.get(\"dkg\", (result) => {\n        const dados = result.dkg || {};\n        if (!dados[valorAtual])\n            dados[valorAtual] = [];\n        const jaExiste = dados[valorAtual].some(item => item.link === linkClicado.href);\n        if (!jaExiste) {\n            dados[valorAtual].push({\n                link: linkClicado.href,\n                rank: index + 1,\n                horario: Date.now()\n            });\n            chrome.storage.local.set({ dkg: dados }, () => {\n                // Espera ~100ms antes de redirecionar, garantindo que o storage foi escrito\n                setTimeout(() => {\n                    window.location.href = linkClicado.href;\n                }, 100);\n            });\n        }\n    });\n    window.location.href = linkClicado.href;\n}\n"],"names":[],"sourceRoot":""}